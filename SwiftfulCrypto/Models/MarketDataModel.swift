//
//  MarketDataModel.swift
//  SwiftfulCrypto
//
//  Created by Thomas on 1/27/25.
//

import Foundation

struct GlobalData: Codable {
    let data: MarketDataModel?
}

struct MarketDataModel: Codable {
    let totalMarketCap, totalVolume, marketCapPercentage: [String: Double]
    let marketCapChangePercentage24HUsd: Double
    
    enum CodingKeys: String, CodingKey {
        case totalMarketCap = "total_market_cap"
        case totalVolume = "total_volume"
        case marketCapPercentage = "market_cap_percentage"
        case marketCapChangePercentage24HUsd = "market_cap_change_percentage_24h_usd"
    }
    var marketCap: String {
        if let item = totalMarketCap.first(where: { $0.key == "usd" }) {
            return "$" + item.value.formattedWithAbbreviations()
        }
        return ""
    }
    var volume: String {
        if let item = totalVolume.first(where: { $0.key == "usd"}) {
            return "$" + item.value.formattedWithAbbreviations()
        }
        return ""
    }
    var btcDominance: String {
        if let item = marketCapPercentage.first(where: { $0.key == "btc" }) {
            return item.value.asPercentString()
        }
        return ""
    }
}


/*
 URL: https://api.coingecko.com/api/v3/global
 JSON Response
 {
   "data": {
     "active_cryptocurrencies": 16950,
     "upcoming_icos": 0,
     "ongoing_icos": 49,
     "ended_icos": 3376,
     "markets": 1216,
     "total_market_cap": {
       "btc": 35453115.606576696,
       "eth": 1145215444.5071547,
       "ltc": 31939627104.561703,
       "bch": 8573571228.033778,
       "bnb": 5396540666.627933,
       "eos": 4806091088551.048,
       "xrp": 1212840413944.667,
       "xlm": 9053947558416.834,
       "link": 151346513425.53165,
       "dot": 613290230954.628,
       "yfi": 496096478.4175593,
       "usd": 3583208596062.1484,
       "aed": 13161125173336.28,
       "ars": 3762351271066661.5,
       "aud": 5701615850888.479,
       "bdt": 437002509071078.1,
       "bhd": 1350565067984.7656,
       "bmd": 3583208596062.1484,
       "brl": 21262759809032.805,
       "cad": 5154069328532.817,
       "chf": 3227284903006.7017,
       "clp": 3527489702393384.5,
       "cny": 25982741332195.668,
       "czk": 85608683240310.58,
       "dkk": 25467662262928.93,
       "eur": 3412841360153.78,
       "gbp": 2872658331463.026,
       "gel": 10283808670698.371,
       "hkd": 27905544812971.562,
       "huf": 1395256845025249.2,
       "idr": 57952048363049300,
       "ils": 12920720542209.277,
       "inr": 309380694292313.4,
       "jpy": 553046747550616.44,
       "krw": 5144419317798590,
       "kwd": 1103907737857.6353,
       "lkr": 1069647025028313.6,
       "mmk": 7517571634538391,
       "mxn": 74004827689240.1,
       "myr": 15685495629262.066,
       "ngn": 5582638992664828,
       "nok": 40263483029874.71,
       "nzd": 6303139827535.219,
       "php": 209177871180886.38,
       "pkr": 997923594003308.9,
       "pln": 14373077399990.977,
       "rub": 350077917556324.25,
       "sar": 13440973764688.732,
       "sek": 39190222475139.18,
       "sgd": 4816763987342.507,
       "thb": 120813252629129.52,
       "try": 128067763004588,
       "twd": 117797989761960.39,
       "uah": 150465848124448.72,
       "vef": 358786676723.7032,
       "vnd": 89866871589238720,
       "zar": 66972454747485.875,
       "xdr": 2739377304523.8984,
       "xag": 118031786956.43623,
       "xau": 1306867839.1557877,
       "bits": 35453115606576.695,
       "sats": 3545311560657669.5
     },
     "total_volume": {
       "btc": 2250132.4725903515,
       "eth": 72684344.25885886,
       "ltc": 2027138965.9494228,
       "bch": 544145999.4756134,
       "bnb": 342506749.7137355,
       "eos": 305032193632.3621,
       "xrp": 76976354624.8265,
       "xlm": 574634444893.3185,
       "link": 9605635460.962053,
       "dot": 38924202857.29281,
       "yfi": 31486169.17092595,
       "usd": 227418490028.80475,
       "aed": 835308113875.8003,
       "ars": 238788287671626.84,
       "aud": 361869211007.79443,
       "bdt": 27735602906557.637,
       "bhd": 85717440169.207,
       "bmd": 227418490028.80475,
       "brl": 1349501319830.9282,
       "cad": 327117618964.9828,
       "chf": 204828783995.7537,
       "clp": 223882132508856.97,
       "cny": 1649068325821.3713,
       "czk": 5433397736671.426,
       "dkk": 1616377372716.7107,
       "eur": 216605650501.89532,
       "gbp": 182321403456.09286,
       "gel": 652691066382.6699,
       "hkd": 1771104498848.1787,
       "huf": 88553930476363.69,
       "idr": 3678091012419626.5,
       "ils": 820050152542.7877,
       "inr": 19635722692043.023,
       "jpy": 35100679425005.85,
       "krw": 326505153681116.44,
       "kwd": 70062633571.09416,
       "lkr": 67888180320586.35,
       "mmk": 477123992080432.56,
       "mxn": 4696926153399.123,
       "myr": 995524440101.0935,
       "ngn": 354318007464877.8,
       "nok": 2555436075928.552,
       "nzd": 400046635184.3999,
       "php": 13276066501871.03,
       "pkr": 63336049473022.16,
       "pln": 912228097176.733,
       "rub": 22218687321352.586,
       "sar": 853069497947.0499,
       "sek": 2487318552702.673,
       "sgd": 305709579406.1213,
       "thb": 7667755519056.2,
       "try": 8128183582691.168,
       "twd": 7476383314533.94,
       "uah": 9549741541413.764,
       "vef": 22771413406.584232,
       "vnd": 5703655729922425,
       "zar": 4250596671635.001,
       "xdr": 173862345300.98145,
       "xag": 7491221916.171338,
       "xau": 82944071.68330571,
       "bits": 2250132472590.3516,
       "sats": 225013247259035.16
     },
     "market_cap_percentage": {
       "btc": 55.8929974445577,
       "eth": 10.518225300106266,
       "xrp": 4.752282603453701,
       "usdt": 3.8805495828759224,
       "sol": 3.1694952283288274,
       "bnb": 2.700315847575005,
       "usdc": 1.4566847224227437,
       "doge": 1.3445651176072004,
       "ada": 0.9189854355641781,
       "steth": 0.8329650847736211
     },
     "market_cap_change_percentage_24h_usd": -5.828393721561315,
     "updated_at": 1737993806
   }
 }
 
 */
